<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>Maybe</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: white;
      font-family: "Noto Serif SC", serif;
      font-size: 18px;
      overflow-y: auto;
      height: auto;
      min-height: 100vh;
      position: relative;
    }

    #canvas {
      position: relative;
      width: 100%;
      max-width: 800px;
      margin: 80px auto;
      padding: 0 20px 120px;
      box-sizing: border-box;
      min-height: 100vh;
      z-index: 2;
    }

    .char-wrapper {
      position: absolute;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 32px;
      opacity: 0;
    }

    .char {
      font-size: 18px;
      color: black;
      z-index: 2;
    }

    .circle {
      position: absolute;
      width: 28px;
      height: 28px;
      border: 1px solid rgba(0, 0, 0, 0.4);
      border-radius: 50%;
      z-index: 1;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(1);
      opacity: 0.5;
      animation: popout 2.5s ease-out forwards;
      pointer-events: none;
    }

    @keyframes popout {
      0% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 0.5;
      }
      100% {
        transform: translate(-50%, -50%) scale(2.5);
        opacity: 0;
      }
    }

    .snowflake {
      position: fixed;
      top: -10px;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.1);
      pointer-events: none;
      z-index: 1;
    }

    #overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: black;
      opacity: 0;
      pointer-events: none;
      z-index: 3;
      transition: opacity 50s linear;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }

    #final-text {
      color: white;
      font-size: 20px;
      text-align: center;
      white-space: pre-wrap;
      opacity: 0;
      transition: opacity 3s ease-in;
    }
  </style>
</head>
<body>
  <div id="overlay">
    <div id="final-text">
万物守恒，如果你还在计较得失的话，
那么我向你提出分手，好吗。</div>
  </div>
  <div id="canvas"></div>

  <script>
    const poem = `我读懂了你的犹豫。
我理解你可能是真的在认真思考，也明白你不是故意不说。

但对我来说，这种被悬着的状态，很消耗，也很疼。
你说“还没想好”的时候，我脑海就开始构造各种可能的结局。
我在不停拆解你没说出口的意思，也在试图调整自己的反应和期待。
我不是没耐心，我是真的会累。

我当然愿意等你——只要你也在努力。
但如果只是我在撑、我在猜、我在反复调节自己，
那这种等待，对我来说就不是期待，而是凌迟。

我不怕你不确定。
但我希望你能说出来，不要让我去猜。

如果你真的在衡量，那就说说你在衡量什么；
你有顾虑就告诉我；你有期待就明讲；你觉得我不够好，也可以说。
你甚至可以告诉我要换取你的喜欢，我需要付出的代价这些的，我可以试试看。

我不怕面对问题，也不怕听到真话。
我怕的是，你什么都不说，让我一个人兜住全部不确定。
我讨厌这种模糊、猜测和被动。
讨厌你算好了我会做什么，然后等着我去说、我去做、我去扛。

这段关系不该只有一个人在推进。
不平等终会坍塌。走不远的。
如果是这样的话，我愿意主动提出分手`;

    const container = document.getElementById("canvas");
    const lines = poem.split('\n');

    const charWidth = 28;
    const lineHeight = 34;
    const baseX = 20;
    const baseY = 0;

    const allChars = [];

    lines.forEach((line, row) => {
      [...line].forEach((char, col) => {
        const wrapper = document.createElement('div');
        wrapper.className = 'char-wrapper';

        const charSpan = document.createElement('span');
        charSpan.className = 'char';
        charSpan.textContent = char;

        wrapper.appendChild(charSpan);
        container.appendChild(wrapper);

        const startX = -60 + Math.random() * 120;
        const startY = -100 + Math.random() * 80;
        wrapper.style.left = `${startX}px`;
        wrapper.style.top = `${startY}px`;

        const finalX = baseX + col * charWidth;
        const finalY = baseY + row * lineHeight;

        allChars.push({
          el: wrapper,
          targetX: finalX,
          targetY: finalY,
        });
      });
    });

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    shuffle(allChars);

    allChars.forEach((item, i) => {
      const { el, targetX, targetY } = item;
      const delay = i * 40 + Math.random() * 80;

      setTimeout(() => {
        el.style.transition = 'all 800ms ease-out';
        el.style.left = `${targetX}px`;
        el.style.top = `${targetY}px`;
        el.style.opacity = 1;

        const circle = document.createElement('div');
        circle.className = 'circle';
        el.appendChild(circle);

        setTimeout(() => {
          circle.remove();
        }, 3000);
      }, delay);
    });

    function createSnowflake() {
      const flake = document.createElement('div');
      flake.className = 'snowflake';
      flake.style.left = `${Math.random() * window.innerWidth}px`;
      document.body.appendChild(flake);

      let top = -10;
      const speed = 1 + Math.random() * 2;
      const drift = (Math.random() - 0.5) * 2;

      function fall() {
        top += speed;
        flake.style.top = `${top}px`;
        flake.style.left = `${parseFloat(flake.style.left) + drift}px`;
        if (top < window.innerHeight) {
          requestAnimationFrame(fall);
        }
      }
      fall();
    }

    setInterval(() => {
      for (let i = 0; i < 15; i++) createSnowflake();
    }, 80);

    setTimeout(() => {
      const overlay = document.getElementById('overlay');
      overlay.style.opacity = 1;
      setTimeout(() => {
        const text = document.getElementById('final-text');
        text.style.opacity = 1;
      }, 61000);
    }, 100);
  </script>
</body>
</html>
